Bootstrap:docker
From:nfcore/base

%labels
    MAINTAINER David
    DESCRIPTION Container for various RNA seq analyses
    VERSION 0.0.1
%environment
    PATH=/opt/bin:/usr/local/bin:/opt/conda/envs/rnatools/bin/:$PATH
%files
    # /data/bnf/sw/bcl2fastq2-v2.20.0.422-Source.tar.gz /opt
    # picard.jar /usr/local/bin
    # trimmomatic-0.39.jar /usr/local/bin
    # FastQ-Screen-0.14.1.tar.gz /
    environment.yml /
%post
    rm -rf /var/lib/apt/lists/*
    apt -y clean
    apt -y update

    ## install softwares
    apt -y install libz-dev build-essential gettext cmake libxml2-dev libcurl4-openssl-dev libssl-dev make libbz2-dev libboost-dev python3-pip sudo tree


    ## set up python environment defined in .yml file
    /opt/conda/bin/conda env create -f /environment.yml


%test
    #!/bin/sh
    exec R --slave -e "installed.packages()"


    # Umi_tools
    #pip3 install Cython
    #pip3 install umi_tools

%runscript
    echo "Welcome to the CTG RNAseq container with R and all that stuff"
    exec /bin/bash
    exec R --slave -e "sessionInfo()"
    exec R --slave -e "installed.packages()"
